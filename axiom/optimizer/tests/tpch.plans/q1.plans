numWorkers: 1
numDrivers: 1

Query Graph:

dt1: l_returnflag, l_linestatus, sum_qty, sum_base_price, sum_disc_price, sum_charge, avg_qty, avg_price, avg_disc, count_order
  output:
    l_returnflag := t2.l_returnflag
    l_linestatus := t2.l_linestatus
    sum_qty := dt1.sum_qty
    sum_base_price := dt1.sum_base_price
    sum_disc_price := dt1.sum_disc_price
    sum_charge := dt1.sum_charge
    avg_qty := dt1.avg_qty
    avg_price := dt1.avg_price
    avg_disc := dt1.avg_disc
    count_order := dt1.count_order
  tables: t2
  aggregates: sum(t2.l_quantity) AS sum_qty, sum(t2.l_extendedprice) AS sum_base_price, sum(multiply(t2.l_extendedprice, minus(1, t2.l_discount))) AS sum_disc_price, sum(multiply(multiply(t2.l_extendedprice, minus(1, t2.l_discount)), plus(t2.l_tax, 1))) AS sum_charge, avg(t2.l_quantity) AS avg_qty, avg(t2.l_extendedprice) AS avg_price, avg(t2.l_discount) AS avg_disc, count() AS count_order
  grouping keys: t2.l_returnflag, t2.l_linestatus
  orderBy: t2.l_returnflag ASC NULLS LAST, t2.l_linestatus ASC NULLS LAST

t2: l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate
  table: lineitem
  single-column filters: lt(t2.l_shipdate, "1998-09-03")


Optimized plan (oneline):

agg(lineitem)

Optimized plan:

Project (redundant) -> dt1.l_returnflag, dt1.l_linestatus, dt1.sum_qty, dt1.sum_base_price, dt1.sum_disc_price, dt1.sum_charge, dt1.avg_qty, dt1.avg_price, dt1.avg_disc, dt1.count_order
    dt1.l_returnflag := t2.l_returnflag
    dt1.l_linestatus := t2.l_linestatus
    dt1.sum_qty := dt1.sum_qty
    dt1.sum_base_price := dt1.sum_base_price
    dt1.sum_disc_price := dt1.sum_disc_price
    dt1.sum_charge := dt1.sum_charge
    dt1.avg_qty := dt1.avg_qty
    dt1.avg_price := dt1.avg_price
    dt1.avg_disc := dt1.avg_disc
    dt1.count_order := dt1.count_order
  OrderBy -> t2.l_returnflag, t2.l_linestatus, dt1.sum_qty, dt1.sum_base_price, dt1.sum_disc_price, dt1.sum_charge, dt1.avg_qty, dt1.avg_price, dt1.avg_disc, dt1.count_order
    Aggregation (t2.l_returnflag, t2.l_linestatus) -> t2.l_returnflag, t2.l_linestatus, dt1.sum_qty, dt1.sum_base_price, dt1.sum_disc_price, dt1.sum_charge, dt1.avg_qty, dt1.avg_price, dt1.avg_disc, dt1.count_order
        dt1.sum_qty := sum(t2.l_quantity)
        dt1.sum_base_price := sum(t2.l_extendedprice)
        dt1.sum_disc_price := sum(dt1.__p41)
        dt1.sum_charge := sum(dt1.__p48)
        dt1.avg_qty := avg(t2.l_quantity)
        dt1.avg_price := avg(t2.l_extendedprice)
        dt1.avg_disc := avg(t2.l_discount)
        dt1.count_order := count()
      Project -> t2.l_returnflag, t2.l_linestatus, t2.l_quantity, t2.l_extendedprice, dt1.__p41, dt1.__p48, t2.l_discount
          t2.l_returnflag := t2.l_returnflag
          t2.l_linestatus := t2.l_linestatus
          t2.l_quantity := t2.l_quantity
          t2.l_extendedprice := t2.l_extendedprice
          dt1.__p41 := multiply(t2.l_extendedprice, minus(1, t2.l_discount))
          dt1.__p48 := multiply(multiply(t2.l_extendedprice, minus(1, t2.l_discount)), plus(t2.l_tax, 1))
          t2.l_discount := t2.l_discount
        TableScan -> t2.l_quantity, t2.l_extendedprice, t2.l_discount, t2.l_tax, t2.l_returnflag, t2.l_linestatus
          table: lineitem
          single-column filters: lt(t2.l_shipdate, "1998-09-03")


Executable Velox plan:

Fragment 0:  numWorkers=0:
-- OrderBy[3][l_returnflag ASC NULLS LAST, l_linestatus ASC NULLS LAST] -> l_returnflag:VARCHAR, l_linestatus:VARCHAR, sum_qty:DOUBLE, sum_base_price:DOUBLE, sum_disc_price:DOUBLE, sum_charge:DOUBLE, avg_qty:DOUBLE, avg_price:DOUBLE, avg_disc:DOUBLE, count_order:BIGINT
  -- Aggregation[2][SINGLE [l_returnflag, l_linestatus] sum_qty := sum("l_quantity"), sum_base_price := sum("l_extendedprice"), sum_disc_price := sum("dt1.__p41"), sum_charge := sum("dt1.__p48"), avg_qty := avg("l_quantity"), avg_price := avg("l_extendedprice"), avg_disc := avg("l_discount"), count_order := count()] -> l_returnflag:VARCHAR, l_linestatus:VARCHAR, sum_qty:DOUBLE, sum_base_price:DOUBLE, sum_disc_price:DOUBLE, sum_charge:DOUBLE, avg_qty:DOUBLE, avg_price:DOUBLE, avg_disc:DOUBLE, count_order:BIGINT
    -- Project[1][expressions: (l_returnflag:VARCHAR, "l_returnflag"), (l_linestatus:VARCHAR, "l_linestatus"), (l_quantity:DOUBLE, "l_quantity"), (l_extendedprice:DOUBLE, "l_extendedprice"), (dt1.__p41:DOUBLE, multiply("l_extendedprice",minus(1,"l_discount"))), (dt1.__p48:DOUBLE, multiply(multiply("l_extendedprice",minus(1,"l_discount")),plus("l_tax",1))), (l_discount:DOUBLE, "l_discount")] -> l_returnflag:VARCHAR, l_linestatus:VARCHAR, l_quantity:DOUBLE, l_extendedprice:DOUBLE, "dt1.__p41":DOUBLE, "dt1.__p48":DOUBLE, l_discount:DOUBLE
      -- TableScan[0][table: lineitem, range filters: [(l_shipdate, BigintRange: [-9223372036854775808, 10471] no nulls)], data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>, filter column handles: [HiveColumnHandle [name: l_shipdate, columnType: Regular, dataType: DATE, requiredSubfields: [ ]]]] -> l_quantity:DOUBLE, l_extendedprice:DOUBLE, l_discount:DOUBLE, l_tax:DOUBLE, l_returnflag:VARCHAR, l_linestatus:VARCHAR

___END___
