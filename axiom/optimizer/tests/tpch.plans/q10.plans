numWorkers: 1
numDrivers: 1

Query Graph:

dt1: c_custkey, c_name, revenue, c_acctbal, n_name, c_address, c_phone, c_comment
  output:
    c_custkey := t2.c_custkey
    c_name := t2.c_name
    revenue := dt1.revenue
    c_acctbal := t2.c_acctbal
    n_name := t5.n_name
    c_address := t2.c_address
    c_phone := t2.c_phone
    c_comment := t2.c_comment
  tables: t2, t3, t4, t5
  joins:
    t2 INNER t3 ON t2.c_custkey = t3.o_custkey
    t3 INNER t4 ON t3.o_orderkey = t4.l_orderkey
    t2 INNER t5 ON t2.c_nationkey = t5.n_nationkey
  syntactic join order: 11, 30, 52, 63
  aggregates: sum(multiply(t4.l_extendedprice, minus(1, t4.l_discount))) AS revenue
  grouping keys: t2.c_custkey, t2.c_name, t2.c_acctbal, t2.c_phone, t5.n_name, t2.c_address, t2.c_comment
  orderBy: dt1.revenue DESC NULLS LAST
  limit: 20

t2: c_custkey, c_name, c_address, c_nationkey, c_phone, c_acctbal, c_comment
  table: customer

t3: o_orderkey, o_custkey, o_orderdate
  table: orders
  single-column filters: gte(t3.o_orderdate, "1993-10-01") and lt(t3.o_orderdate, "1994-01-01")

t4: l_orderkey, l_extendedprice, l_discount, l_returnflag
  table: lineitem
  single-column filters: eq(t4.l_returnflag, "R")

t5: n_nationkey, n_name
  table: nation


Optimized plan (oneline):

agg((lineitem INNER ((customer INNER orders) INNER nation)))

Optimized plan:

Project -> dt1.c_custkey, dt1.c_name, dt1.revenue, dt1.c_acctbal, dt1.n_name, dt1.c_address, dt1.c_phone, dt1.c_comment
    dt1.c_custkey := t2.c_custkey
    dt1.c_name := t2.c_name
    dt1.revenue := dt1.revenue
    dt1.c_acctbal := t2.c_acctbal
    dt1.n_name := t5.n_name
    dt1.c_address := t2.c_address
    dt1.c_phone := t2.c_phone
    dt1.c_comment := t2.c_comment
  OrderBy -> t2.c_custkey, t2.c_name, t2.c_acctbal, t2.c_phone, t5.n_name, t2.c_address, t2.c_comment, dt1.revenue
    Aggregation (t2.c_custkey, t2.c_name, t2.c_acctbal, t2.c_phone, t5.n_name, t2.c_address, t2.c_comment) -> t2.c_custkey, t2.c_name, t2.c_acctbal, t2.c_phone, t5.n_name, t2.c_address, t2.c_comment, dt1.revenue
        dt1.revenue := sum(dt1.__p84)
      Project -> t2.c_custkey, t2.c_name, t2.c_acctbal, t2.c_phone, t5.n_name, t2.c_address, t2.c_comment, dt1.__p84
          t2.c_custkey := t2.c_custkey
          t2.c_name := t2.c_name
          t2.c_acctbal := t2.c_acctbal
          t2.c_phone := t2.c_phone
          t5.n_name := t5.n_name
          t2.c_address := t2.c_address
          t2.c_comment := t2.c_comment
          dt1.__p84 := multiply(t4.l_extendedprice, minus(1, t4.l_discount))
        Join INNER Hash -> t2.c_custkey, t2.c_name, t2.c_address, t2.c_phone, t2.c_acctbal, t2.c_comment, t4.l_extendedprice, t4.l_discount, t5.n_name
            t4.l_orderkey = t3.o_orderkey
          TableScan -> t4.l_orderkey, t4.l_extendedprice, t4.l_discount
            table: lineitem
            single-column filters: eq(t4.l_returnflag, "R")
          Join INNER Hash -> t2.c_custkey, t2.c_name, t2.c_address, t2.c_phone, t2.c_acctbal, t2.c_comment, t3.o_orderkey, t5.n_name
              t2.c_nationkey = t5.n_nationkey
            Join INNER Hash -> t2.c_custkey, t2.c_name, t2.c_address, t2.c_nationkey, t2.c_phone, t2.c_acctbal, t2.c_comment, t3.o_orderkey
                t2.c_custkey = t3.o_custkey
              TableScan -> t2.c_custkey, t2.c_name, t2.c_address, t2.c_nationkey, t2.c_phone, t2.c_acctbal, t2.c_comment
                table: customer
              TableScan -> t3.o_orderkey, t3.o_custkey
                table: orders
                single-column filters: gte(t3.o_orderdate, "1993-10-01") and lt(t3.o_orderdate, "1994-01-01")
            TableScan -> t5.n_nationkey, t5.n_name
              table: nation


Executable Velox plan:

Fragment 0:  numWorkers=0:
-- Project[10][expressions: (c_custkey:BIGINT, "c_custkey"), (c_name:VARCHAR, "c_name"), (revenue:DOUBLE, "revenue"), (c_acctbal:DOUBLE, "c_acctbal"), (n_name:VARCHAR, "n_name"), (c_address:VARCHAR, "c_address"), (c_phone:VARCHAR, "c_phone"), (c_comment:VARCHAR, "c_comment")] -> c_custkey:BIGINT, c_name:VARCHAR, revenue:DOUBLE, c_acctbal:DOUBLE, n_name:VARCHAR, c_address:VARCHAR, c_phone:VARCHAR, c_comment:VARCHAR
  -- TopN[9][20 revenue DESC NULLS LAST] -> c_custkey:BIGINT, c_name:VARCHAR, c_acctbal:DOUBLE, c_phone:VARCHAR, n_name:VARCHAR, c_address:VARCHAR, c_comment:VARCHAR, revenue:DOUBLE
    -- Aggregation[8][SINGLE [c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment] revenue := sum("dt1.__p84")] -> c_custkey:BIGINT, c_name:VARCHAR, c_acctbal:DOUBLE, c_phone:VARCHAR, n_name:VARCHAR, c_address:VARCHAR, c_comment:VARCHAR, revenue:DOUBLE
      -- Project[7][expressions: (c_custkey:BIGINT, "c_custkey"), (c_name:VARCHAR, "c_name"), (c_acctbal:DOUBLE, "c_acctbal"), (c_phone:VARCHAR, "c_phone"), (n_name:VARCHAR, "n_name"), (c_address:VARCHAR, "c_address"), (c_comment:VARCHAR, "c_comment"), (dt1.__p84:DOUBLE, multiply("l_extendedprice",minus(1,"l_discount")))] -> c_custkey:BIGINT, c_name:VARCHAR, c_acctbal:DOUBLE, c_phone:VARCHAR, n_name:VARCHAR, c_address:VARCHAR, c_comment:VARCHAR, "dt1.__p84":DOUBLE
        -- HashJoin[6][INNER l_orderkey=o_orderkey] -> c_custkey:BIGINT, c_name:VARCHAR, c_address:VARCHAR, c_phone:VARCHAR, c_acctbal:DOUBLE, c_comment:VARCHAR, l_extendedprice:DOUBLE, l_discount:DOUBLE, n_name:VARCHAR
          -- TableScan[0][table: lineitem, range filters: [(l_returnflag, Filter(BytesValues, deterministic, no nulls))], data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>, filter column handles: [HiveColumnHandle [name: l_returnflag, columnType: Regular, dataType: VARCHAR, requiredSubfields: [ ]]]] -> l_orderkey:BIGINT, l_extendedprice:DOUBLE, l_discount:DOUBLE
          -- HashJoin[5][INNER c_nationkey=n_nationkey] -> c_custkey:BIGINT, c_name:VARCHAR, c_address:VARCHAR, c_phone:VARCHAR, c_acctbal:DOUBLE, c_comment:VARCHAR, o_orderkey:BIGINT, n_name:VARCHAR
            -- HashJoin[3][INNER c_custkey=o_custkey] -> c_custkey:BIGINT, c_name:VARCHAR, c_address:VARCHAR, c_nationkey:BIGINT, c_phone:VARCHAR, c_acctbal:DOUBLE, c_comment:VARCHAR, o_orderkey:BIGINT
              -- TableScan[1][table: customer, data columns: ROW<c_custkey:BIGINT,c_name:VARCHAR,c_address:VARCHAR,c_nationkey:BIGINT,c_phone:VARCHAR,c_acctbal:DOUBLE,c_mktsegment:VARCHAR,c_comment:VARCHAR>] -> c_custkey:BIGINT, c_name:VARCHAR, c_address:VARCHAR, c_nationkey:BIGINT, c_phone:VARCHAR, c_acctbal:DOUBLE, c_comment:VARCHAR
              -- TableScan[2][table: orders, range filters: [(o_orderdate, BigintRange: [8674, 8765] no nulls)], data columns: ROW<o_orderkey:BIGINT,o_custkey:BIGINT,o_orderstatus:VARCHAR,o_totalprice:DOUBLE,o_orderdate:DATE,o_orderpriority:VARCHAR,o_clerk:VARCHAR,o_shippriority:INTEGER,o_comment:VARCHAR>, filter column handles: [HiveColumnHandle [name: o_orderdate, columnType: Regular, dataType: DATE, requiredSubfields: [ ]]]] -> o_orderkey:BIGINT, o_custkey:BIGINT
            -- TableScan[4][table: nation, data columns: ROW<n_nationkey:BIGINT,n_name:VARCHAR,n_regionkey:BIGINT,n_comment:VARCHAR>] -> n_nationkey:BIGINT, n_name:VARCHAR

___END___
