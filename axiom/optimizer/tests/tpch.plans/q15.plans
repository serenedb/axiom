numWorkers: 1
numDrivers: 1

Query Graph:

dt1: s_suppkey, s_name, s_address, s_phone, total_revenue
  output:
    s_suppkey := t2.s_suppkey
    s_name := t2.s_name
    s_address := t2.s_address
    s_phone := t2.s_phone
    total_revenue := dt3.total_revenue
  tables: t2, dt3, dt7
  joins:
    t2 INNER dt3 ON t2.s_suppkey = dt3.l_suppkey
    dt3 INNER dt7 ON dt3.total_revenue = dt7.max
  syntactic join order: 8, 13, 76
  orderBy: t2.s_suppkey ASC NULLS LAST

t2: s_suppkey, s_name, s_address, s_phone
  table: supplier

dt3: l_suppkey, total_revenue
  output:
    l_suppkey := t4.l_suppkey
    total_revenue := dt3.total_revenue
  tables: t4
  aggregates: sum(multiply(t4.l_extendedprice, minus(1, t4.l_discount))) AS total_revenue
  grouping keys: t4.l_suppkey

t4: l_suppkey, l_extendedprice, l_discount, l_shipdate
  table: lineitem
  single-column filters: gte(t4.l_shipdate, "1996-01-01") and lt(__cast(t4.l_shipdate), "1996-04-01")

dt7: max
  output:
    max := dt7.max
  tables: dt5
  aggregates: max(dt5.total_revenue_19) AS max

dt5: total_revenue_19
  output:
    total_revenue_19 := dt5.total_revenue_17
  tables: t6
  aggregates: sum(multiply(t6.l_extendedprice, minus(1, t6.l_discount))) AS total_revenue_17
  grouping keys: t6.l_suppkey

t6: l_suppkey, l_extendedprice, l_discount, l_shipdate
  table: lineitem
  single-column filters: gte(t6.l_shipdate, "1996-01-01") and lt(__cast(t6.l_shipdate), "1996-04-01")


Optimized plan (oneline):

((lineitem INNER lineitem) INNER supplier)

Optimized plan:

Project (redundant) -> dt1.s_suppkey, dt1.s_name, dt1.s_address, dt1.s_phone, dt1.total_revenue
    dt1.s_suppkey := t2.s_suppkey
    dt1.s_name := t2.s_name
    dt1.s_address := t2.s_address
    dt1.s_phone := t2.s_phone
    dt1.total_revenue := dt3.total_revenue
  OrderBy -> t2.s_suppkey, t2.s_name, t2.s_address, t2.s_phone, dt3.total_revenue
    Join INNER Hash -> t2.s_suppkey, t2.s_name, t2.s_address, t2.s_phone, dt3.total_revenue
        dt3.l_suppkey = t2.s_suppkey
      Join INNER Hash -> dt3.total_revenue, dt3.l_suppkey
          dt3.total_revenue = dt7.max
        Project (redundant) -> dt3.l_suppkey, dt3.total_revenue
            dt3.l_suppkey := t4.l_suppkey
            dt3.total_revenue := dt3.total_revenue
          Aggregation (t4.l_suppkey) -> t4.l_suppkey, dt3.total_revenue
              dt3.total_revenue := sum(dt3.__p49)
            Project -> t4.l_suppkey, dt3.__p49
                t4.l_suppkey := t4.l_suppkey
                dt3.__p49 := multiply(t4.l_extendedprice, minus(1, t4.l_discount))
              TableScan -> t4.l_suppkey, t4.l_extendedprice, t4.l_discount
                table: lineitem
                single-column filters: gte(t4.l_shipdate, "1996-01-01") and lt(__cast(t4.l_shipdate), "1996-04-01")
        HashBuild -> dt7.max
          Project (redundant) -> dt7.max
              dt7.max := dt7.max
            Aggregation -> dt7.max
                dt7.max := max(dt5.total_revenue_19)
              Project -> dt5.total_revenue_19
                  dt5.total_revenue_19 := dt5.total_revenue_17
                Aggregation (t6.l_suppkey) -> t6.l_suppkey, dt5.total_revenue_17
                    dt5.total_revenue_17 := sum(dt5.__p71)
                  Project -> t6.l_suppkey, dt5.__p71
                      t6.l_suppkey := t6.l_suppkey
                      dt5.__p71 := multiply(t6.l_extendedprice, minus(1, t6.l_discount))
                    TableScan -> t6.l_suppkey, t6.l_extendedprice, t6.l_discount
                      table: lineitem
                      single-column filters: gte(t6.l_shipdate, "1996-01-01") and lt(__cast(t6.l_shipdate), "1996-04-01")
      HashBuild -> t2.s_suppkey, t2.s_name, t2.s_address, t2.s_phone
        TableScan -> t2.s_suppkey, t2.s_name, t2.s_address, t2.s_phone
          table: supplier


Executable Velox plan:

Fragment 0:  numWorkers=0:
-- OrderBy[11][s_suppkey ASC NULLS LAST] -> s_suppkey:BIGINT, s_name:VARCHAR, s_address:VARCHAR, s_phone:VARCHAR, total_revenue:DOUBLE
  -- HashJoin[10][INNER l_suppkey=s_suppkey] -> s_suppkey:BIGINT, s_name:VARCHAR, s_address:VARCHAR, s_phone:VARCHAR, total_revenue:DOUBLE
    -- HashJoin[8][INNER total_revenue=max] -> total_revenue:DOUBLE, l_suppkey:BIGINT
      -- Aggregation[2][SINGLE [l_suppkey] total_revenue := sum("dt3.__p49")] -> l_suppkey:BIGINT, total_revenue:DOUBLE
        -- Project[1][expressions: (l_suppkey:BIGINT, "l_suppkey"), (dt3.__p49:DOUBLE, multiply("l_extendedprice",minus(1,"l_discount")))] -> l_suppkey:BIGINT, "dt3.__p49":DOUBLE
          -- TableScan[0][table: lineitem, range filters: [(l_shipdate, BigintRange: [9496, 9223372036854775807] no nulls)], remaining filter: (lt(cast("l_shipdate" as DATE),1996-04-01)), data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>] -> l_suppkey:BIGINT, l_extendedprice:DOUBLE, l_discount:DOUBLE
      -- Aggregation[7][SINGLE max := max("total_revenue_19")] -> max:DOUBLE
        -- Project[6][expressions: (total_revenue_19:DOUBLE, "total_revenue_17")] -> total_revenue_19:DOUBLE
          -- Aggregation[5][SINGLE [l_suppkey_2] total_revenue_17 := sum("dt5.__p71")] -> l_suppkey_2:BIGINT, total_revenue_17:DOUBLE
            -- Project[4][expressions: (l_suppkey_2:BIGINT, "l_suppkey_2"), (dt5.__p71:DOUBLE, multiply("l_extendedprice_5",minus(1,"l_discount_6")))] -> l_suppkey_2:BIGINT, "dt5.__p71":DOUBLE
              -- TableScan[3][table: lineitem, range filters: [(l_shipdate, BigintRange: [9496, 9223372036854775807] no nulls)], remaining filter: (lt(cast("l_shipdate" as DATE),1996-04-01)), data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>] -> l_suppkey_2:BIGINT, l_extendedprice_5:DOUBLE, l_discount_6:DOUBLE
    -- TableScan[9][table: supplier, data columns: ROW<s_suppkey:BIGINT,s_name:VARCHAR,s_address:VARCHAR,s_nationkey:BIGINT,s_phone:VARCHAR,s_acctbal:DOUBLE,s_comment:VARCHAR>] -> s_suppkey:BIGINT, s_name:VARCHAR, s_address:VARCHAR, s_phone:VARCHAR

___END___
