numWorkers: 1
numDrivers: 1

Query Graph:

dt1: o_orderpriority, order_count
  output:
    o_orderpriority := t2.o_orderpriority
    order_count := dt1.order_count
  tables: t2, dt3
  joins:
    t2 SEMI dt3 ON t2.o_orderkey = dt3.l_orderkey
  syntactic join order: 12, 16
  aggregates: count() AS order_count
  grouping keys: t2.o_orderpriority
  filter: dt1.__mark0
  orderBy: t2.o_orderpriority ASC NULLS LAST

t2: o_orderkey, o_orderdate, o_orderpriority
  table: orders
  single-column filters: gte(t2.o_orderdate, "1993-07-01") and lt(t2.o_orderdate, "1993-10-01")

dt3: l_orderkey
  output:
    l_orderkey := t4.l_orderkey
  tables: t4

t4: l_orderkey, l_commitdate, l_receiptdate
  table: lineitem
  multi-column filters: lt(t4.l_commitdate, t4.l_receiptdate)


Optimized plan (oneline):

agg((lineitem RIGHT SEMI (FILTER) orders))

Optimized plan:

Project (redundant) -> dt1.o_orderpriority, dt1.order_count
    dt1.o_orderpriority := t2.o_orderpriority
    dt1.order_count := dt1.order_count
  OrderBy -> t2.o_orderpriority, dt1.order_count
    Aggregation (t2.o_orderpriority) -> t2.o_orderpriority, dt1.order_count
        dt1.order_count := count()
      Join RIGHT SEMI (FILTER) Hash -> t2.o_orderpriority
          dt3.l_orderkey = t2.o_orderkey
        Project (redundant) -> dt3.l_orderkey
            dt3.l_orderkey := t4.l_orderkey
          TableScan -> t4.l_orderkey
            table: lineitem
            multi-column filters: lt(t4.l_commitdate, t4.l_receiptdate)
        TableScan -> t2.o_orderkey, t2.o_orderpriority
          table: orders
          single-column filters: gte(t2.o_orderdate, "1993-07-01") and lt(t2.o_orderdate, "1993-10-01")


Executable Velox plan:

Fragment 0:  numWorkers=0:
-- OrderBy[4][o_orderpriority ASC NULLS LAST] -> o_orderpriority:VARCHAR, order_count:BIGINT
  -- Aggregation[3][SINGLE [o_orderpriority] order_count := count()] -> o_orderpriority:VARCHAR, order_count:BIGINT
    -- HashJoin[2][RIGHT SEMI (FILTER) l_orderkey=o_orderkey] -> o_orderpriority:VARCHAR
      -- TableScan[0][table: lineitem, remaining filter: (lt("l_commitdate","l_receiptdate")), data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>, filter column handles: [HiveColumnHandle [name: l_receiptdate, columnType: Regular, dataType: DATE, requiredSubfields: [ ]], HiveColumnHandle [name: l_commitdate, columnType: Regular, dataType: DATE, requiredSubfields: [ ]]]] -> l_orderkey:BIGINT
      -- TableScan[1][table: orders, range filters: [(o_orderdate, BigintRange: [8582, 8673] no nulls)], data columns: ROW<o_orderkey:BIGINT,o_custkey:BIGINT,o_orderstatus:VARCHAR,o_totalprice:DOUBLE,o_orderdate:DATE,o_orderpriority:VARCHAR,o_clerk:VARCHAR,o_shippriority:INTEGER,o_comment:VARCHAR>, filter column handles: [HiveColumnHandle [name: o_orderdate, columnType: Regular, dataType: DATE, requiredSubfields: [ ]]]] -> o_orderkey:BIGINT, o_orderpriority:VARCHAR

___END___
